#!/bin/sh

echo "Running pre-commit checks..."

# 1. Validate package-lock.json
echo "→ Validating package-lock.json..."
npm ci --dry-run > /dev/null 2>&1

if [ $? -ne 0 ]; then
  echo "✗ package-lock.json is out of sync with package.json"
  echo "  Run: npm install"
  exit 1
fi

# 2. Run ESLint
echo "→ Linting code..."
npm run lint

if [ $? -ne 0 ]; then
  echo "✗ Linting failed. Please fix errors."
  exit 1
fi

# 3. Run TypeScript type check
echo "→ Type checking..."
npm run typecheck

if [ $? -ne 0 ]; then
  echo "✗ TypeScript check failed. Please fix type errors."
  exit 1
fi

echo "✓ Pre-commit checks passed!"
